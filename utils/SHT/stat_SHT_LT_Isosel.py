import os
from ete3 import Tree
from ete3 import PhyloTree
import numpy as np 
import glob

l = ["ENSGT00940000158488","ENSGT00940000169600","ENSGT00940000163110","ENSGT00960000188992","ENSGT00390000004452","ENSGT00740000117046","ENSGT00530000065389","ENSGT00480000043246","ENSGT00940000162554","ENSGT00940000165548","ENSGT00940000160433","ENSGT00940000159954","ENSGT00670000099476","ENSGT00940000172903","ENSGT00410000028303","ENSGT00940000156483","ENSGT00390000014590","ENSGT00390000005328","ENSGT00940000164149","ENSGT00940000157680","ENSGT00900000143393","ENSGT00860000135738","ENSGT00390000001511","ENSGT00940000161662","ENSGT00530000068397","ENSGT00940000175733","ENSGT00940000158809","ENSGT00940000177095","ENSGT00940000154633","ENSGT00940000158387","ENSGT00940000167178","ENSGT00940000161156","ENSGT00720000108822","ENSGT00940000178591","ENSGT00940000155594","ENSGT00910000148008","ENSGT00940000158046","ENSGT00940000177470","ENSGT00960000191110","ENSGT00940000162882","ENSGT00390000015236","ENSGT00940000155651","ENSGT00940000161971","ENSGT00910000147325","ENSGT00390000013727","ENSGT00950000185758","ENSGT00910000147087","ENSGT00910000148088","ENSGT00940000165652","ENSGT00940000164774","ENSGT00940000156549","ENSGT00860000135092","ENSGT00910000147247","ENSGT00940000168794","ENSGT00940000176370","ENSGT00940000161095","ENSGT00950000183038","ENSGT00940000160160","ENSGT00940000156022","ENSGT00910000147324","ENSGT00730000111085","ENSGT00910000146929","ENSGT00940000165389","ENSGT00940000169631","ENSGT00940000179666","ENSGT00910000148089","ENSGT00910000147855","ENSGT00940000156489","ENSGT00940000154634","ENSGT00860000134468","ENSGT00940000165675","ENSGT00940000156816","ENSGT00390000013823","ENSGT00390000006939","ENSGT00390000013249","ENSGT00940000169756","ENSGT00910000147974","ENSGT00940000178784","ENSGT00940000154635","ENSGT00910000146924","ENSGT00900000143602","ENSGT00730000112044","ENSGT00910000144335","ENSGT00530000065031","ENSGT00910000147034","ENSGT00910000146973","ENSGT00950000183203","ENSGT00940000178120","ENSGT00940000159007","ENSGT00390000009155","ENSGT00510000048991","ENSGT00940000163297","ENSGT00940000156290","ENSGT00940000157113","ENSGT00420000029792","ENSGT00390000007612","ENSGT00530000063255","ENSGT00940000154639","ENSGT00910000147088","ENSGT00940000161512","ENSGT00900000143336","ENSGT00390000003282","ENSGT00940000158806","ENSGT00940000166937","ENSGT00940000168987","ENSGT00960000186833","ENSGT00390000008744","ENSGT00940000177112","ENSGT00940000159421","ENSGT00940000158111","ENSGT00730000111138","ENSGT00960000190051","ENSGT00390000015663","ENSGT00940000171555","ENSGT00390000006227","ENSGT00940000153472","ENSGT00940000177329","ENSGT00910000147528","ENSGT00940000170234","ENSGT00390000016274","ENSGT00940000168587","ENSGT00510000049510","ENSGT00390000015102","ENSGT00940000180404","ENSGT00950000183248","ENSGT00940000157805","ENSGT00940000164582","ENSGT00910000147031","ENSGT00940000155543","ENSGT00910000147964","ENSGT00730000111482","ENSGT00940000157494","ENSGT00910000147036","ENSGT00940000165964","ENSGT00940000162075","ENSGT00940000179508","ENSGT00940000160970","ENSGT00910000147086","ENSGT00940000156292","ENSGT00390000012174","ENSGT00940000166658","ENSGT00910000146899","ENSGT00910000147249","ENSGT00940000157459","ENSGT00940000180406","ENSGT00730000112793","ENSGT00900000143765","ENSGT00910000147035","ENSGT00910000147299","ENSGT00440000034918","ENSGT00940000168718","ENSGT00940000159129","ENSGT00910000147038","ENSGT00390000003308","ENSGT00550000075099","ENSGT00390000004396","ENSGT00530000063787","ENSGT00940000155347","ENSGT00660000097220","ENSGT00550000074618","ENSGT00910000148466","ENSGT00720000108834","ENSGT00910000147430","ENSGT00690000103118","ENSGT00940000178990","ENSGT00940000154956","ENSGT00940000164868","ENSGT00910000147635","ENSGT00940000163213","ENSGT00950000182721","ENSGT00940000166690","ENSGT00390000003337","ENSGT00940000177296","ENSGT00940000161450","ENSGT00940000168688","ENSGT00940000160474","ENSGT00940000178375","ENSGT00940000178042","ENSGT00940000165381","ENSGT00940000162246","ENSGT00470000042571","ENSGT00910000147901","ENSGT00940000177118","ENSGT00940000166522","ENSGT00940000157965","ENSGT00940000177785","ENSGT00910000147033","ENSGT00910000147240","ENSGT00940000169936","ENSGT00940000177143","ENSGT00910000146517","ENSGT00940000157964","ENSGT00940000178325","ENSGT00390000009061","ENSGT00550000076464","ENSGT00390000016470","ENSGT00910000146988","ENSGT00910000147437","ENSGT00940000167593","ENSGT00940000167230","ENSGT00940000178526","ENSGT00940000162652","ENSGT00860000136093","ENSGT00530000067688","ENSGT00390000015899","ENSGT00510000048187","ENSGT00390000011138","ENSGT00940000178658","ENSGT00640000091497","ENSGT00910000146962","ENSGT00390000005708","ENSGT00510000046760","ENSGT00940000166797","ENSGT00940000163053","ENSGT00720000109834","ENSGT00910000146928","ENSGT00950000183306","ENSGT00940000176391","ENSGT00940000161809","ENSGT00390000012605","ENSGT00910000147327","ENSGT00940000177259","ENSGT00530000064699","ENSGT00910000147294","ENSGT00950000182836","ENSGT00390000015552","ENSGT00860000135909","ENSGT00910000146975"]

sameTreeSTH_LT = 0
sameTreeSTH_LTBD = 0
sameTreeSTH_ISOSEL = 0

for id in l:
    file = open("ensemblGeneTree/trees_100_0/" + id  + ".nw", "r")
    tree_lines = file.readlines()

    treeFromtreeBest = PhyloTree(tree_lines[0])
    treeFromEnsembl = PhyloTree(tree_lines[2])
    treeFromReconstructEnsembl = PhyloTree(tree_lines[3])
    treeFromIsosel = PhyloTree(tree_lines[4])	    
    
    #rf_1, max_rf, common_leaves, parts_t1, parts_t2, v5, v6 = treeFromtreeBest.robinson_foulds(treeFromEnsembl)
    #if id == "ENSGT00860000136165":
    print(tree_lines[0])
    print(tree_lines[2])
        
    if tree_lines[0] == tree_lines[2]:
        sameTreeSTH_LT +=1
                  
    #rf_2, max_rf, common_leaves, parts_t1, parts_t2, v5, v6 = treeFromtreeBest.robinson_foulds(treeFromReconstructEnsembl)
    if tree_lines[0] == tree_lines[3]:
        sameTreeSTH_LTBD +=1
        
                
    ##rf_3, max_rf, common_leaves, parts_t1, parts_t2, v5, v6 = treeFromtreeBest.robinson_foulds(treeFromIsosel)
    if tree_lines[0] == tree_lines[4]:
        sameTreeSTH_ISOSEL +=1            
       
print(sameTreeSTH_LT, sameTreeSTH_LTBD, sameTreeSTH_ISOSEL)
